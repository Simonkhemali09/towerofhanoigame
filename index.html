<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tower of Hanoi - Modern Edition</title>
    <style>
        :root {
            --bg-color: #0f172a;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text-color: #f8fafc;
            --accent: #38bdf8;
            --peg-color: #475569;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(circle at center, #1e293b, #0f172a);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
        }

        /* Header & Stats */
        .header { text-align: center; margin-top: 2rem; }
        .stats-container {
            display: flex;
            gap: 2rem;
            margin: 1.5rem 0;
            padding: 1rem 2rem;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
        }

        /* Controls */
        .controls { margin-bottom: 2rem; }
        select, button {
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            border: 1px solid var(--glass-border);
            background: var(--glass-bg);
            color: white;
            cursor: pointer;
            transition: 0.3s;
        }
        button:hover { background: var(--accent); color: #000; }

        /* Game Board */
        .game-board {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 40px;
            width: 100%;
            max-width: 900px;
            height: 300px;
            padding: 20px;
            position: relative;
        }

        .peg {
            width: 160px;
            height: 100%;
            display: flex;
            flex-direction: column-reverse;
            align-items: center;
            position: relative;
            cursor: pointer;
            border-bottom: 8px solid var(--peg-color);
            border-radius: 4px;
        }

        /* The vertical stick */
        .peg::before {
            content: '';
            position: absolute;
            bottom: 0;
            width: 12px;
            height: 100%;
            background: var(--peg-color);
            border-radius: 10px 10px 0 0;
            z-index: 0;
        }

        .disk {
            height: 30px;
            border-radius: 15px;
            z-index: 1;
            transition: transform 0.2s, bottom 0.5s;
            cursor: grab;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.8rem;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .disk.selected {
            transform: translateY(-20px);
            box-shadow: 0 0 15px var(--accent);
            border-color: var(--accent);
        }

        /* Win Modal */
        #win-modal {
            display: none;
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(15, 23, 42, 0.95);
            padding: 3rem;
            border-radius: 20px;
            border: 2px solid var(--accent);
            text-align: center;
            z-index: 10;
            backdrop-filter: blur(15px);
        }

        @media (max-width: 600px) {
            .game-board { gap: 10px; height: 250px; }
            .peg { width: 100px; }
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>Tower of Hanoi</h1>
    </div>

    <div class="stats-container">
        <div>Moves: <span id="move-count">0</span></div>
        <div>Time: <span id="timer">00:00</span></div>
    </div>

    <div class="controls">
        <label>Disks: </label>
        <select id="disk-count">
            <option value="3">3</option>
            <option value="4" selected>4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
        </select>
        <button onclick="resetGame()">Reset Game</button>
    </div>

    <div class="game-board" id="board">
        <div class="peg" data-peg="0" ondrop="drop(event)" ondragover="allowDrop(event)" onclick="handlePegClick(0)"></div>
        <div class="peg" data-peg="1" ondrop="drop(event)" ondragover="allowDrop(event)" onclick="handlePegClick(1)"></div>
        <div class="peg" data-peg="2" ondrop="drop(event)" ondragover="allowDrop(event)" onclick="handlePegClick(2)"></div>
    </div>

    <div id="win-modal">
        <h2 style="color: var(--accent);">Victory!</h2>
        <p id="win-message"></p>
        <button onclick="resetGame()">Play Again</button>
    </div>

    <script>
        let moves = 0;
        let timerInterval;
        let seconds = 0;
        let selectedDisk = null;
        const colors = ['#ef4444', '#f59e0b', '#10b981', '#3b82f6', '#6366f1', '#8b5cf6', '#ec4899'];

        const board = document.getElementById('board');
        const pegs = document.querySelectorAll('.peg');
        const diskSelect = document.getElementById('disk-count');

        function initGame() {
            moves = 0;
            seconds = 0;
            selectedDisk = null;
            document.getElementById('move-count').innerText = moves;
            document.getElementById('timer').innerText = "00:00";
            document.getElementById('win-modal').style.display = 'none';
            clearInterval(timerInterval);
            
            pegs.forEach(peg => peg.innerHTML = '');
            
            const count = parseInt(diskSelect.value);
            for (let i = count; i > 0; i--) {
                const disk = document.createElement('div');
                disk.className = 'disk';
                disk.draggable = true;
                disk.id = 'disk-' + i;
                disk.dataset.size = i;
                disk.style.width = (40 + (i * 15)) + 'px';
                disk.style.backgroundColor = colors[i - 1];
                disk.innerText = i;
                
                // Events
                disk.ondragstart = drag;
                pegs[0].appendChild(disk);
            }
            startTimer();
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                seconds++;
                const mins = String(Math.floor(seconds / 60)).padStart(2, '0');
                const secs = String(seconds % 60).padStart(2, '0');
                document.getElementById('timer').innerText = `${mins}:${secs}`;
            }, 1000);
        }

        // Drag and Drop Logic
        function allowDrop(ev) { ev.preventDefault(); }

        function drag(ev) {
            const peg = ev.target.parentNode;
            if (peg.lastChild !== ev.target) {
                ev.preventDefault();
                return;
            }
            ev.dataTransfer.setData("text", ev.target.id);
        }

        function drop(ev) {
            ev.preventDefault();
            const data = ev.dataTransfer.getData("text");
            const disk = document.getElementById(data);
            const targetPeg = ev.currentTarget;
            executeMove(disk, targetPeg);
        }

        // Click-to-Move Logic (Accessibility)
        function handlePegClick(index) {
            const peg = pegs[index];
            const topDisk = peg.lastChild;

            if (!selectedDisk) {
                if (topDisk) {
                    selectedDisk = topDisk;
                    selectedDisk.classList.add('selected');
                }
            } else {
                if (executeMove(selectedDisk, peg)) {
                    selectedDisk.classList.remove('selected');
                    selectedDisk = null;
                } else if (topDisk === selectedDisk) {
                    selectedDisk.classList.remove('selected');
                    selectedDisk = null;
                }
            }
        }

        function executeMove(disk, targetPeg) {
            const targetDisk = targetPeg.lastChild;
            
            if (!targetDisk || parseInt(disk.dataset.size) < parseInt(targetDisk.dataset.size)) {
                targetPeg.appendChild(disk);
                moves++;
                document.getElementById('move-count').innerText = moves;
                checkWin();
                return true;
            }
            return false;
        }

        function checkWin() {
            const count = parseInt(diskSelect.value);
            if (pegs[2].childElementCount === count) {
                clearInterval(timerInterval);
                document.getElementById('win-modal').style.display = 'block';
                document.getElementById('win-message').innerText = 
                    `Completed with ${count} disks in ${moves} moves and ${document.getElementById('timer').innerText}!`;
            }
        }

        function resetGame() { initGame(); }

        // Initial setup
        diskSelect.addEventListener('change', initGame);
        initGame();
    </script>
</body>
</html>